<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Profile</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    
    
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular-route.min.js"></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
    <link rel="stylesheet" type="text/css" href="../../css/codesnippets/sunburst.css" />
    <script src="js/dp.js"></script>
    <style>
        body{
            padding-top : 60px;
        }
    </style>
</head>
<body ng-app="CourseApp">
    <div class="container" ng-controller="loginController">
         <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">Project name</a>

        </div>
        <div id="navbar" class="navbar-collapse collapse">
                            <ul class="nav navbar-nav left">
                                <li><a href="#/home">Home</a></li>
                                <li><a href="#/about">About</a></li>
                                <li><a href="#/contact">Contact</a></li>
                                <li ng-show="currentUser"><a href="#/profile/{{currentUser.username}}">Profile</a></li>                  
                            </ul>

                            <form ng-show="!currentUser" class="navbar-form navbar-right">
                                <div class="form-group">
                                    <input type="text" placeholder="Username" ng-model="username" ng-click="clear()" class="form-control">
                                </div>
                                <div class="form-group">
                                    <input type="password" ng-model="password" placeholder="Password" ng-click="psclear()" class="form-control">
                                </div>
                                <button type="submit" class={{color}} ng-click="login()">Sign in</button>
                            </form>
                        <form ng-show="currentUser" class="navbar-form navbar-right">
                            
                            <button type="submit" class="btn btn-danger" ng-click="logout()">Logout</button>
                        </form>
                        </div><!--/.navbar-collapse -->
        </nav>
        <div ng-view>

        </div>
         <div class="container">
        <hr />
        <h1>About the Experiment</h1>
        <p><b>Username: isha Password: isha</b></p>
        <p><b>Username: admin Password: admin</b></p>
        
        <p>
            In this experiment, user is able to login to his profile and edit the profile picture. I have added an extra feature of photo in user data. when there is no pic, it shows the default one. Otherwise when user has chosen some picture, it checks for the type of file and stores the image as binary data base 64. On save changes event, this data is passed to loginService which stores it in user profile photo.
        </p>

        <span id="text">
            <pre class="prettyprint">
  if (window.File && window.FileReader && window.FileList && window.Blob) {
        document.getElementById('filePicker').addEventListener('change', handleFileSelect, false);
    } else {
        alert('The File APIs are not fully supported in this browser.');
    }

     var handleFileSelect = function (evt) {
        var files = evt.target.files;
        var file = files[0];

        if (files && file) {
            var reader = new FileReader();

            reader.onload = function (readerEvt) {
                var binaryString = readerEvt.target.result;
                $scope.loc = "data:image/jpeg;base64," + btoa(binaryString);
                LoginService.updatePhoto($scope.loc);
            };

            reader.readAsBinaryString(file);
        }
    };
            </pre>
        </span>
            <h3>Description</h3>
            <p>Here first the file type is checked. And an eventlistner is added to the filepicker element. So whenever a file is chosen, handleFileSelect fn is called which stores the data in file as 64 base binary string and passes it to loginService.</p>
    </div>

    <hr />

    <h1>Source Code</h1>
    <div id="doc">
        <a href="../../fileview/Default.aspx?~/experiments/week6/profile_pic.html"
           target="_blank">View Source Code</a>
    </div>
    
    <div id="Div5">
        <a href="../../fileview/Default.aspx?~/experiments/week6/js/dp.js"
           target="_blank">View JS Code</a>
    </div>

        <div id="Div1">
        <a href="../../fileview/Default.aspx?~/experiments/week6/courseApp/dp.html"
           target="_blank">View Profile Code</a>
    </div>
    <hr />
    <h1>Reference</h1>
    <div id="Div6">
        <a href="http://stackoverflow.com/questions/18571001/file-upload-using-angularjs">Stack Overflow</a>
    </div>
        </div>
</body>
</html>
